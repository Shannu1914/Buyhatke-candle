<%- include('../partials/header') %>

<section class="admin-section" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); min-height: 100vh; padding: 50px 0;">
  <div class="admin-card">
    <h1>Manage Users</h1>

    <% if (users && users.length > 0) { %>
      <div class="table-responsive">
        <table class="admin-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Name</th>
              <th>Email</th>
              <th>Role</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% users.forEach((user, index) => { %>
              <tr>
                <td><%= index + 1 %></td>
                <td><%= user.name %></td>
                <td><%= user.email %></td>
                <td>
                  <span class="role <%= user.isAdmin ? 'role-admin' : 'role-user' %>">
                    <%= user.isAdmin ? 'Admin' : 'User' %>
                  </span>
                </td>
                <td style="padding:10px;">
                  <form action="/admin/users/delete/<%= user._id %>" method="POST" style="display:inline;">
                    <button type="submit" class="btn btn-danger btn-small">Delete</button>
                  </form>

                  <% if (!user.isAdmin) { %>
                    <form action="/admin/users/toggle-admin/<%= user._id %>" method="POST" style="display:inline;">
                      <button type="submit" class="btn btn-primary btn-small">Make Admin</button>
                    </form>
                  <% } else { %>
                    <form action="/admin/users/toggle-admin/<%= user._id %>" method="POST" style="display:inline;">
                      <button type="submit" class="btn btn-secondary btn-small">Revoke Admin</button>
                    </form>
                  <% } %>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    <% } else { %>
      <p>No users found.</p>
    <% } %>
  </div>
</section>

<%- include('../partials/footer') %>
