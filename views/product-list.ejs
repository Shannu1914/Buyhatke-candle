<%- include('partials/header', { title: 'Shop', active: 'shop' }) %>

<%- include('partials/seo', {
  title: 'Buyhatke Shop - Candles',
  description: 'Browse our collection of handcrafted candles for home, gifts, and special occasions.',
  keywords: 'candles, scented candles, gift candles, Buyhatke',
  path: '/shop'
}) %>

<section class="shop-section container">
  <h1>Shop Candles</h1>

  <!-- Search Form -->
  <form method="GET" action="/products" class="search-form">
    <input type="text" name="search" placeholder="Search candles..." value="<%= search %>" />
    <button type="submit">Search</button>
  </form>

  <!-- Category Filter -->
  <form method="GET" action="/products">
    <select name="category" onchange="this.form.submit()">
      <option value="">All Categories</option>
      <% if (categories && categories.length > 0) { %>
        <% categories.forEach(cat => { %>
          <option value="<%= cat.name %>" <%= selectedCategory === cat.name ? 'selected' : '' %>>
            <%= cat.name %>
          </option>
        <% }) %>
      <% } %>
    </select>
  </form>

  <!-- Products Grid -->
  <% if (!products || products.length === 0) { %>
    <p>No products found.</p>
  <% } else { %>
    <div class="product-grid">
      <% products.forEach(product => { %>
        <div class="product-card">
          <div class="product-thumb">
            <img src="/uploads/products/<%= product.image %>" 
                 alt="<%= product.name %>" 
                 class="product-img" />
          </div>
          <h3><%= product.name %></h3>
          <p class="price">â‚¹<%= product.price %></p>
          <a href="/products/<%= product._id %>" class="btn btn-secondary">View</a>
        </div>
      <% }) %>
    </div>
  <% } %>
</section>

<%- include('partials/footer') %>
